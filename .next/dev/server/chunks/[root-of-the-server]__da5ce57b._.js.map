{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/lib/gemini.ts"],"sourcesContent":["import { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nconst apiKey = process.env.GEMINI_API_KEY;\r\nif (!apiKey) {\r\n    console.warn(\"GEMINI_API_KEY not found in environment variables\");\r\n}\r\n\r\nconst genAI = new GoogleGenerativeAI(apiKey || \"\");\r\n\r\nexport const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;AACzC,IAAI,CAAC,QAAQ;IACT,QAAQ,IAAI,CAAC;AACjB;AAEA,MAAM,QAAQ,IAAI,sLAAkB,CAAC,UAAU;AAExC,MAAM,QAAQ,MAAM,kBAAkB,CAAC;IAAE,OAAO;AAAmB"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/app/api/ai/millet-price/route.ts"],"sourcesContent":["import { model } from \"@/lib/gemini\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { region, quantity, crop } = await req.json();\r\n\r\n        // Try Gemini AI first\r\n        try {\r\n            if (!process.env.GEMINI_API_KEY) {\r\n                throw new Error(\"API key not configured\");\r\n            }\r\n\r\n            const prompt = `Predict the market price for ${quantity} kg of ${crop} in ${region}. Return a JSON object with: \r\n    - estimatedPrice (number)\r\n    - priceTrend (string: \"up\", \"down\", \"stable\")\r\n    - factors (string[])\r\n    - advice (string)\r\n    Do not use markdown formatting.`;\r\n\r\n            const result = await model.generateContent(prompt);\r\n            const response = await result.response;\r\n            const text = response.text();\r\n            const cleanText = text.replace(/```json/g, \"\").replace(/```/g, \"\").trim();\r\n\r\n            return NextResponse.json(JSON.parse(cleanText), { status: 200 });\r\n        } catch (aiError: any) {\r\n            console.warn(\"Gemini AI failed, using fallback:\", aiError.message);\r\n\r\n            // Fallback: Return mock prediction\r\n            const mockPrediction = {\r\n                estimatedPrice: Math.floor(Math.random() * (100 - 60) + 60),\r\n                priceTrend: [\"up\", \"down\", \"stable\"][Math.floor(Math.random() * 3)],\r\n                factors: [\r\n                    \"Seasonal demand in \" + region,\r\n                    \"Current market surplus\",\r\n                    \"Transportation costs\"\r\n                ],\r\n                advice: `Based on ${quantity} kg of ${crop} in ${region}, consider selling during peak demand season for better returns.`\r\n            };\r\n\r\n            return NextResponse.json(mockPrediction, { status: 200 });\r\n        }\r\n    } catch (error: any) {\r\n        console.error(\"AI Price Prediction Error:\", error);\r\n        return NextResponse.json(\r\n            { message: `Failed to predict price: ${error.message || \"Unknown error\"}` },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QAEjD,sBAAsB;QACtB,IAAI;YACA,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;gBAC7B,MAAM,IAAI,MAAM;YACpB;YAEA,MAAM,SAAS,CAAC,6BAA6B,EAAE,SAAS,OAAO,EAAE,KAAK,IAAI,EAAE,OAAO;;;;;mCAK5D,CAAC;YAExB,MAAM,SAAS,MAAM,+HAAK,CAAC,eAAe,CAAC;YAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;YACtC,MAAM,OAAO,SAAS,IAAI;YAC1B,MAAM,YAAY,KAAK,OAAO,CAAC,YAAY,IAAI,OAAO,CAAC,QAAQ,IAAI,IAAI;YAEvE,OAAO,gJAAY,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC,YAAY;gBAAE,QAAQ;YAAI;QAClE,EAAE,OAAO,SAAc;YACnB,QAAQ,IAAI,CAAC,qCAAqC,QAAQ,OAAO;YAEjE,mCAAmC;YACnC,MAAM,iBAAiB;gBACnB,gBAAgB,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,MAAM,EAAE,IAAI;gBACxD,YAAY;oBAAC;oBAAM;oBAAQ;iBAAS,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,GAAG;gBACnE,SAAS;oBACL,wBAAwB;oBACxB;oBACA;iBACH;gBACD,QAAQ,CAAC,SAAS,EAAE,SAAS,OAAO,EAAE,KAAK,IAAI,EAAE,OAAO,gEAAgE,CAAC;YAC7H;YAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,gBAAgB;gBAAE,QAAQ;YAAI;QAC3D;IACJ,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS,CAAC,yBAAyB,EAAE,MAAM,OAAO,IAAI,iBAAiB;QAAC,GAC1E;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}