{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/pc/OneDrive/Desktop/Major%20Projects%20Using%20Next%20JS/1.snapcartFolder/1.snapcart/src/proxy.ts"],"sourcesContent":["import { getToken } from \"next-auth/jwt\"\r\nimport { NextRequest, NextResponse } from \"next/server\"\r\n\r\nexport async function proxy(req:NextRequest){\r\n\r\n    const {pathname}=req.nextUrl\r\n   \r\n    const publicRoutes=[\"/login\",\"/register\",\"/api/auth\",\"/unauthorized\"]\r\n     if(publicRoutes.some((path)=>pathname.startsWith(path))){\r\n        return NextResponse.next()\r\n     }\r\nconst token=await getToken({req,secret:process.env.NEXTAUTH_SECRET})\r\nconsole.log(token)\r\nconsole.log(req.url)\r\nif(!token){\r\n  const loginUrl=new URL(\"/login\",req.url)\r\n   loginUrl.searchParams.set(\"callbackUrl\",req.url)\r\n   return NextResponse.redirect(loginUrl)\r\n}\r\n\r\nconst role=token.role\r\nif(pathname.startsWith(\"/user\") && role!==\"user\"){\r\n  return NextResponse.redirect(new URL(\"/unauthorized\",req.url))\r\n}\r\nif(pathname.startsWith(\"/delivery\") && role!==\"deliveryBoy\"){\r\n  return NextResponse.redirect(new URL(\"/unauthorized\",req.url))\r\n}\r\nif(pathname.startsWith(\"/admin\") && role!==\"admin\"){\r\n  return NextResponse.redirect(new URL(\"/unauthorized\",req.url))\r\n}\r\n\r\n\r\nreturn NextResponse.next()\r\n\r\n}\r\n\r\nexport const config = {\r\n  matcher:'/((?!api|_next/static|_next/image|favicon.ico).*)',\r\n}\r\n\r\n\r\n// req------middleware------server"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe,MAAM,GAAe;IAEvC,MAAM,EAAC,QAAQ,EAAC,GAAC,IAAI,OAAO;IAE5B,MAAM,eAAa;QAAC;QAAS;QAAY;QAAY;KAAgB;IACpE,IAAG,aAAa,IAAI,CAAC,CAAC,OAAO,SAAS,UAAU,CAAC,QAAO;QACrD,OAAO,8IAAY,CAAC,IAAI;IAC3B;IACL,MAAM,QAAM,MAAM,IAAA,iJAAQ,EAAC;QAAC;QAAI,QAAO,QAAQ,GAAG,CAAC,eAAe;IAAA;IAClE,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC,IAAI,GAAG;IACnB,IAAG,CAAC,OAAM;QACR,MAAM,WAAS,IAAI,IAAI,UAAS,IAAI,GAAG;QACtC,SAAS,YAAY,CAAC,GAAG,CAAC,eAAc,IAAI,GAAG;QAC/C,OAAO,8IAAY,CAAC,QAAQ,CAAC;IAChC;IAEA,MAAM,OAAK,MAAM,IAAI;IACrB,IAAG,SAAS,UAAU,CAAC,YAAY,SAAO,QAAO;QAC/C,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAgB,IAAI,GAAG;IAC9D;IACA,IAAG,SAAS,UAAU,CAAC,gBAAgB,SAAO,eAAc;QAC1D,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAgB,IAAI,GAAG;IAC9D;IACA,IAAG,SAAS,UAAU,CAAC,aAAa,SAAO,SAAQ;QACjD,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAgB,IAAI,GAAG;IAC9D;IAGA,OAAO,8IAAY,CAAC,IAAI;AAExB;AAEO,MAAM,SAAS;IACpB,SAAQ;AACV,EAGA,kCAAkC"}}]
}