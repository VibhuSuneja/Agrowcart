{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst mongodbUrl=process.env.MONGODB_URL\r\n\r\nif(!mongodbUrl){\r\n throw new Error(\"db error\")\r\n}\r\n\r\n\r\n\r\nlet cached=global.mongoose\r\nif(!cached){\r\n    cached=global.mongoose={conn:null,promise:null}\r\n}\r\n\r\nconst connectDb=async ()=>{\r\n    if(cached.conn){\r\n       \r\n        return cached.conn\r\n    }\r\n\r\n    if(!cached.promise){\r\n      \r\n        cached.promise=mongoose.connect(mongodbUrl).then((conn)=>conn.connection)\r\n    }\r\n    try {\r\n        const conn=await cached.promise\r\n        return conn\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n\r\n}\r\n\r\nexport default connectDb"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAW,QAAQ,GAAG,CAAC,WAAW;AAExC,IAAG,CAAC,YAAW;IACd,MAAM,IAAI,MAAM;AACjB;AAIA,IAAI,SAAO,yDAAO,QAAQ;AAC1B,IAAG,CAAC,QAAO;IACP,SAAO,yDAAO,QAAQ,GAAC;QAAC,MAAK;QAAK,SAAQ;IAAI;AAClD;AAEA,MAAM,YAAU;IACZ,IAAG,OAAO,IAAI,EAAC;QAEX,OAAO,OAAO,IAAI;IACtB;IAEA,IAAG,CAAC,OAAO,OAAO,EAAC;QAEf,OAAO,OAAO,GAAC,oHAAQ,CAAC,OAAO,CAAC,YAAY,IAAI,CAAC,CAAC,OAAO,KAAK,UAAU;IAC5E;IACA,IAAI;QACA,MAAM,OAAK,MAAM,OAAO,OAAO;QAC/B,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,GAAG,CAAC;IAChB;AAEJ;uCAEe"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/models/user.model.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nexport interface IUser {\r\n    _id?: mongoose.Types.ObjectId\r\n    name: string\r\n    email: string\r\n    password?: string\r\n    mobile?: string\r\n    role: \"user\" | \"deliveryBoy\" | \"admin\" | \"farmer\" | \"shg\" | \"buyer\" | \"startup\" | \"processor\"\r\n    image?: string,\r\n    location?: {\r\n        type: {\r\n            type: StringConstructor;\r\n            enum: string[];\r\n            default: string;\r\n        };\r\n        coordinates: {\r\n            type: NumberConstructor[];\r\n            default: number[];\r\n        };\r\n    },\r\n    socketId: string | null\r\n    isOnline: Boolean\r\n    wishlist?: mongoose.Types.ObjectId[]\r\n}\r\n\r\nconst userSchema = new mongoose.Schema<IUser>({\r\n    name: {\r\n        type: String,\r\n        required: true\r\n\r\n    },\r\n    email: {\r\n        type: String,\r\n        unique: true,\r\n        required: true\r\n    },\r\n    password: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    mobile: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    role: {\r\n        type: String,\r\n        enum: [\"user\", \"deliveryBoy\", \"admin\", \"farmer\", \"shg\", \"buyer\", \"startup\", \"processor\"],\r\n        default: \"user\"\r\n    },\r\n    image: {\r\n        type: String\r\n    },\r\n    location: {\r\n        type: {\r\n            type: String,\r\n            enum: [\"Point\"],\r\n            default: \"Point\"\r\n        },\r\n        coordinates: {\r\n            type: [Number],\r\n            default: [0, 0]\r\n        }\r\n    },\r\n    socketId: {\r\n        type: String,\r\n        default: null\r\n    },\r\n    isOnline: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n    wishlist: [{\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: \"Product\"\r\n    }]\r\n}, { timestamps: true })\r\n\r\nuserSchema.index({ location: \"2dsphere\" })\r\n\r\nconst User = mongoose.models.User || mongoose.model(\"User\", userSchema)\r\nexport default User\r\n"],"names":[],"mappings":";;;;AAAA;;AA0BA,MAAM,aAAa,IAAI,oHAAQ,CAAC,MAAM,CAAQ;IAC1C,MAAM;QACF,MAAM;QACN,UAAU;IAEd;IACA,OAAO;QACH,MAAM;QACN,QAAQ;QACR,UAAU;IACd;IACA,UAAU;QACN,MAAM;QACN,UAAU;IACd;IACA,QAAQ;QACJ,MAAM;QACN,UAAU;IACd;IACA,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAQ;YAAe;YAAS;YAAU;YAAO;YAAS;YAAW;SAAY;QACxF,SAAS;IACb;IACA,OAAO;QACH,MAAM;IACV;IACA,UAAU;QACN,MAAM;YACF,MAAM;YACN,MAAM;gBAAC;aAAQ;YACf,SAAS;QACb;QACA,aAAa;YACT,MAAM;gBAAC;aAAO;YACd,SAAS;gBAAC;gBAAG;aAAE;QACnB;IACJ;IACA,UAAU;QACN,MAAM;QACN,SAAS;IACb;IACA,UAAU;QACN,MAAM;QACN,SAAS;IACb;IACA,UAAU;QAAC;YACP,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;YACpC,KAAK;QACT;KAAE;AACN,GAAG;IAAE,YAAY;AAAK;AAEtB,WAAW,KAAK,CAAC;IAAE,UAAU;AAAW;AAExC,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAC,QAAQ;uCAC7C"}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/app/api/auth/register/route.ts"],"sourcesContent":["import connectDb from \"@/lib/db\";\r\nimport User from \"@/models/user.model\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        await connectDb()\r\n        const { name, email, password, role } = await req.json()\r\n        const existUser = await User.findOne({ email })\r\n        if (existUser) {\r\n            return NextResponse.json(\r\n                { message: \"email already exist!\" },\r\n                { status: 400 }\r\n            )\r\n        }\r\n        if (password.length < 6) {\r\n            return NextResponse.json(\r\n                { message: \"password must be at least 6 characters\" },\r\n                { status: 400 }\r\n            )\r\n        }\r\n\r\n        const hashedPassword = await bcrypt.hash(password, 10)\r\n\r\n        // Security: Prevent public registration as admin\r\n        let finalRole = role || 'user'\r\n        if (finalRole === 'admin') {\r\n            return NextResponse.json(\r\n                { message: \"Unauthorized role assignment\" },\r\n                { status: 403 }\r\n            )\r\n        }\r\n\r\n        const user = await User.create({\r\n            name, email, password: hashedPassword, role: finalRole\r\n        })\r\n        return NextResponse.json(\r\n            user,\r\n            { status: 200 }\r\n        )\r\n\r\n    } catch (error: any) {\r\n        console.error(\"Register Error:\", error);\r\n        return NextResponse.json(\r\n            { message: `Register failed: ${error.message || error}` },\r\n            { status: 500 }\r\n        )\r\n    }\r\n}\r\n// connect db\r\n// name,email,password frontend\r\n// email check\r\n// password 6 character\r\n//password hash\r\n// user create\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,IAAA,6HAAS;QACf,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QACtD,MAAM,YAAY,MAAM,2IAAI,CAAC,OAAO,CAAC;YAAE;QAAM;QAC7C,IAAI,WAAW;YACX,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;YAAuB,GAClC;gBAAE,QAAQ;YAAI;QAEtB;QACA,IAAI,SAAS,MAAM,GAAG,GAAG;YACrB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;YAAyC,GACpD;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,iBAAiB,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,iDAAiD;QACjD,IAAI,YAAY,QAAQ;QACxB,IAAI,cAAc,SAAS;YACvB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;YAA+B,GAC1C;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,OAAO,MAAM,2IAAI,CAAC,MAAM,CAAC;YAC3B;YAAM;YAAO,UAAU;YAAgB,MAAM;QACjD;QACA,OAAO,gJAAY,CAAC,IAAI,CACpB,MACA;YAAE,QAAQ;QAAI;IAGtB,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS,CAAC,iBAAiB,EAAE,MAAM,OAAO,IAAI,OAAO;QAAC,GACxD;YAAE,QAAQ;QAAI;IAEtB;AACJ,EACA,aAAa;CACb,+BAA+B;CAC/B,cAAc;CACd,uBAAuB;CACvB,eAAe;CACf,cAAc"}}]
}