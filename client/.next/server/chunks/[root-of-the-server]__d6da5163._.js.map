{"version":3,"sources":["../../../src/lib/db.ts","../../../src/models/order.model.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst mongodbUrl=process.env.MONGODB_URL\r\n\r\nif(!mongodbUrl){\r\n throw new Error(\"db error\")\r\n}\r\n\r\n\r\n\r\nlet cached=global.mongoose\r\nif(!cached){\r\n    cached=global.mongoose={conn:null,promise:null}\r\n}\r\n\r\nconst connectDb=async ()=>{\r\n    if(cached.conn){\r\n       \r\n        return cached.conn\r\n    }\r\n\r\n    if(!cached.promise){\r\n      \r\n        cached.promise=mongoose.connect(mongodbUrl).then((conn)=>conn.connection)\r\n    }\r\n    try {\r\n        const conn=await cached.promise\r\n        return conn\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n\r\n}\r\n\r\nexport default connectDb","import mongoose from \"mongoose\";\r\n\r\n\r\n\r\nexport interface IOrder {\r\n    _id?: mongoose.Types.ObjectId\r\n    user: mongoose.Types.ObjectId\r\n    items: [\r\n        {\r\n            product: mongoose.Types.ObjectId,\r\n            name: string,\r\n            price: string,\r\n            unit: string,\r\n            image: string\r\n            quantity: number\r\n        }\r\n    ]\r\n    ,\r\n    isPaid: boolean\r\n    totalAmount: number,\r\n    paymentMethod: \"cod\" | \"online\"\r\n    address: {\r\n        fullName: string,\r\n        mobile: string,\r\n        city: string,\r\n        state: string,\r\n        pincode: string,\r\n        fullAddress: string,\r\n        latitude: number,\r\n        longitude: number\r\n    }\r\n    assignment?: mongoose.Types.ObjectId\r\n    assignedDeliveryBoy?: mongoose.Types.ObjectId\r\n    status: \"pending\" | \"out of delivery\" | \"delivered\",\r\n    createdAt?: Date\r\n    updatedAt?: Date\r\n    deliveryOtp: string | null\r\n    deliveryOtpVerification: Boolean\r\n    deliveredAt: Date\r\n}\r\n\r\nconst orderSchema = new mongoose.Schema<IOrder>({\r\n    user: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: \"User\",\r\n        required: true\r\n    },\r\n    items: [\r\n        {\r\n            product: {\r\n                type: mongoose.Schema.Types.ObjectId,\r\n                ref: \"Product\",\r\n                required: true\r\n            },\r\n            name: String,\r\n            price: String,\r\n            unit: String,\r\n            image: String,\r\n            quantity: Number\r\n        }\r\n    ],\r\n    paymentMethod: {\r\n        type: String,\r\n        enum: [\"cod\", \"online\"],\r\n        default: \"cod\"\r\n    },\r\n    isPaid: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n    totalAmount: Number,\r\n    address: {\r\n        fullName: String,\r\n        mobile: String,\r\n        city: String,\r\n        state: String,\r\n        pincode: String,\r\n        fullAddress: String,\r\n        latitude: Number,\r\n        longitude: Number\r\n    },\r\n    assignment: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: \"DeliveryAssignment\",\r\n        default: null\r\n    },\r\n\r\n    assignedDeliveryBoy: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: \"User\"\r\n    },\r\n    status: {\r\n        type: String,\r\n        enum: [\"pending\", \"out of delivery\", \"delivered\"],\r\n        default: \"pending\"\r\n    },\r\n    deliveryOtp: {\r\n        type: String,\r\n        default: null\r\n    },\r\n    deliveryOtpVerification: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n    deliveredAt: {\r\n        type: Date\r\n    }\r\n}, { timestamps: true })\r\n\r\n\r\nconst Order = mongoose.models.Order || mongoose.model(\"Order\", orderSchema)\r\nexport default Order"],"names":[],"mappings":"8nCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAW,QAAQ,GAAG,CAAC,WAAW,CAExC,GAAG,CAAC,EACH,MAAM,AAAI,IADI,EACE,YAKjB,IAAI,EAAO,EAAA,CAAA,CAAO,GAAP,KAAe,AACvB,CAAC,GACA,GAAO,EADA,AACA,CAAA,CAAO,EAAP,MAAe,CAAC,CAAC,KAAK,KAAK,QAAQ,KAAI,EAGlD,IAAM,EAAU,UACZ,GAAG,EAAO,IAAI,CAEV,CAFW,MAEJ,EAAO,IAAI,AAGnB,CAAC,EAAO,OAAO,EAAC,CAEf,EAAO,OAAO,CAAC,EAAA,OAAQ,CAAC,OAAO,CAAC,GAAY,IAAI,CAAC,AAAC,GAAO,EAAK,WAAU,EAE5E,GAAI,CAEA,OAAO,AADI,MAAM,EAAO,OAE5B,AAFmC,CAEjC,MAAO,EAAO,CACZ,QAAQ,GAAG,CAAC,EAChB,CAEJ,mBAEe,uzBClCf,IAAA,EAAA,EAAA,CAAA,CAAA,QAyCA,IAAM,EAAc,IAAI,EAAA,OAAQ,CAAC,MAAM,CAAS,CAC5C,KAAM,CACF,KAAM,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CACpC,IAAK,OACL,UAAU,CACd,EACA,MAAO,CACH,CACI,QAAS,CACL,KAAM,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CACpC,IAAK,UACL,UAAU,CACd,EACA,KAAM,OACN,MAAO,OACP,KAAM,OACN,MAAO,OACP,SAAU,MACd,EACH,CACD,cAAe,CACX,KAAM,OACN,KAAM,CAAC,MAAO,SAAS,CACvB,QAAS,KACb,EACA,OAAQ,CACJ,KAAM,QACN,SAAS,CACb,EACA,YAAa,OACb,QAAS,CACL,SAAU,OACV,OAAQ,OACR,KAAM,OACN,MAAO,OACP,QAAS,OACT,YAAa,OACb,SAAU,OACV,UAAW,MACf,EACA,WAAY,CACR,KAAM,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CACpC,IAAK,qBACL,QAAS,IACb,EAEA,oBAAqB,CACjB,KAAM,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CACpC,IAAK,MACT,EACA,OAAQ,CACJ,KAAM,OACN,KAAM,CAAC,UAAW,kBAAmB,YAAY,CACjD,QAAS,SACb,EACA,YAAa,CACT,KAAM,OACN,QAAS,IACb,EACA,wBAAyB,CACrB,KAAM,QACN,SAAS,CACb,EACA,YAAa,CACT,KAAM,IACV,CACJ,EAAG,CAAE,YAAY,CAAK,GAGhB,EAAQ,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,EAAI,EAAA,OAAQ,CAAC,KAAK,CAAC,QAAS,oBAChD"}