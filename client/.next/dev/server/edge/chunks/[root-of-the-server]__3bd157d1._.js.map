{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst mongodbUrl=process.env.MONGODB_URL\r\n\r\nif(!mongodbUrl){\r\n throw new Error(\"db error\")\r\n}\r\n\r\n\r\n\r\nlet cached=global.mongoose\r\nif(!cached){\r\n    cached=global.mongoose={conn:null,promise:null}\r\n}\r\n\r\nconst connectDb=async ()=>{\r\n    if(cached.conn){\r\n       \r\n        return cached.conn\r\n    }\r\n\r\n    if(!cached.promise){\r\n      \r\n        cached.promise=mongoose.connect(mongodbUrl).then((conn)=>conn.connection)\r\n    }\r\n    try {\r\n        const conn=await cached.promise\r\n        return conn\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n\r\n}\r\n\r\nexport default connectDb"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAW,QAAQ,GAAG,CAAC,WAAW;AAExC,IAAG,CAAC,YAAW;IACd,MAAM,IAAI,MAAM;AACjB;AAIA,IAAI,SAAO,yDAAO,QAAQ;AAC1B,IAAG,CAAC,QAAO;IACP,SAAO,yDAAO,QAAQ,GAAC;QAAC,MAAK;QAAK,SAAQ;IAAI;AAClD;AAEA,MAAM,YAAU;IACZ,IAAG,OAAO,IAAI,EAAC;QAEX,OAAO,OAAO,IAAI;IACtB;IAEA,IAAG,CAAC,OAAO,OAAO,EAAC;QAEf,OAAO,OAAO,GAAC,qKAAQ,CAAC,OAAO,CAAC,YAAY,IAAI,CAAC,CAAC,OAAO,KAAK,UAAU;IAC5E;IACA,IAAI;QACA,MAAM,OAAK,MAAM,OAAO,OAAO;QAC/B,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,GAAG,CAAC;IAChB;AAEJ;uCAEe"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/models/user.model.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nexport interface IUser {\r\n    _id?: mongoose.Types.ObjectId\r\n    name: string\r\n    email: string\r\n    password?: string\r\n    mobile?: string\r\n    role: \"user\" | \"deliveryBoy\" | \"admin\" | \"farmer\" | \"shg\" | \"buyer\" | \"startup\" | \"processor\"\r\n    image?: string,\r\n    location?: {\r\n        type: {\r\n            type: StringConstructor;\r\n            enum: string[];\r\n            default: string;\r\n        };\r\n        coordinates: {\r\n            type: NumberConstructor[];\r\n            default: number[];\r\n        };\r\n    },\r\n    socketId: string | null\r\n    isOnline: Boolean\r\n\r\n}\r\n\r\nconst userSchema = new mongoose.Schema<IUser>({\r\n    name: {\r\n        type: String,\r\n        required: true\r\n\r\n    },\r\n    email: {\r\n        type: String,\r\n        unique: true,\r\n        required: true\r\n    },\r\n    password: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    mobile: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    role: {\r\n        type: String,\r\n        enum: [\"user\", \"deliveryBoy\", \"admin\", \"farmer\", \"shg\", \"buyer\", \"startup\", \"processor\"],\r\n        default: \"user\"\r\n    },\r\n    image: {\r\n        type: String\r\n    },\r\n    location: {\r\n        type: {\r\n            type: String,\r\n            enum: [\"Point\"],\r\n            default: \"Point\"\r\n        },\r\n        coordinates: {\r\n            type: [Number],\r\n            default: [0, 0]\r\n        }\r\n    },\r\n    socketId: {\r\n        type: String,\r\n        default: null\r\n    },\r\n    isOnline: {\r\n        type: Boolean,\r\n        default: false\r\n    }\r\n\r\n}, { timestamps: true })\r\n\r\nuserSchema.index({ location: \"2dsphere\" })\r\n\r\nconst User = mongoose.models.User || mongoose.model(\"User\", userSchema)\r\nexport default User\r\n"],"names":[],"mappings":";;;;AAAA;;AA0BA,MAAM,aAAa,IAAI,qKAAQ,CAAC,MAAM,CAAQ;IAC1C,MAAM;QACF,MAAM;QACN,UAAU;IAEd;IACA,OAAO;QACH,MAAM;QACN,QAAQ;QACR,UAAU;IACd;IACA,UAAU;QACN,MAAM;QACN,UAAU;IACd;IACA,QAAQ;QACJ,MAAM;QACN,UAAU;IACd;IACA,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAQ;YAAe;YAAS;YAAU;YAAO;YAAS;YAAW;SAAY;QACxF,SAAS;IACb;IACA,OAAO;QACH,MAAM;IACV;IACA,UAAU;QACN,MAAM;YACF,MAAM;YACN,MAAM;gBAAC;aAAQ;YACf,SAAS;QACb;QACA,aAAa;YACT,MAAM;gBAAC;aAAO;YACd,SAAS;gBAAC;gBAAG;aAAE;QACnB;IACJ;IACA,UAAU;QACN,MAAM;QACN,SAAS;IACb;IACA,UAAU;QACN,MAAM;QACN,SAAS;IACb;AAEJ,GAAG;IAAE,YAAY;AAAK;AAEtB,WAAW,KAAK,CAAC;IAAE,UAAU;AAAW;AAExC,MAAM,OAAO,qKAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,qKAAQ,CAAC,KAAK,CAAC,QAAQ;uCAC7C"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'crypto')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\r\nimport Credentials from \"next-auth/providers/credentials\"\r\nimport connectDb from \"./lib/db\"\r\nimport User from \"./models/user.model\"\r\nimport bcrypt from \"bcryptjs\"\r\nimport Google from \"next-auth/providers/google\"\r\n \r\n\r\nexport const { handlers, signIn, signOut, auth } = NextAuth({\r\n  providers: [\r\n    Credentials({\r\n        credentials: {\r\n        email: { label: \"email\",type:\"email\" },\r\n        password: { label: \"Password\", type: \"password\" },\r\n      } ,\r\n     async authorize(credentials, request) {\r\n         \r\n            await connectDb()\r\n            const email=credentials.email\r\n            const password=credentials.password as string\r\n            const user=await User.findOne({email})\r\n            if(!user){\r\n                throw new Error(\"user does not exist\")\r\n            }\r\n            const isMatch=await bcrypt.compare(password,user.password)\r\n            if(!isMatch){\r\n                throw new Error(\"incorrect password\")\r\n            }\r\n            return {\r\n                id:user._id.toString(),\r\n                email:user.email,\r\n                name:user.name,\r\n                role:user.role\r\n            }\r\n\r\n          } \r\n    \r\n    }),\r\n    Google({\r\n      clientId:process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret:process.env.GOOGLE_CLIENT_SECRET\r\n    })\r\n  ],\r\n  callbacks:{\r\n    // token ke ander user ka data dalta hai\r\n    async signIn({user,account}) {\r\n      console.log(user)\r\n      if(account?.provider==\"google\"){\r\n        await connectDb()\r\n        let dbUser=await User.findOne({email:user.email})\r\n       if(!dbUser){\r\n         dbUser=await User.create({\r\n          name:user.name,\r\n          email:user.email,\r\n          image:user.image\r\n         })\r\n       }\r\n\r\n       user.id=dbUser._id.toString()\r\n       user.role=dbUser.role\r\n      }\r\n      return true\r\n    },\r\n    jwt({token,user,trigger,session}) {\r\n        if(user){\r\n            token.id=user.id,\r\n            token.name=user.name,\r\n            token.email=user.email,\r\n            token.role=user.role\r\n        }\r\n  if(trigger==\"update\"){\r\n    token.role=session.role\r\n  }\r\n\r\n\r\n        return token\r\n    },\r\n    session({session,token}) {\r\n        if(session.user){\r\n            session.user.id=token.id as string,\r\n            session.user.name=token.name as string,\r\n            session.user.email=token.email as string\r\n             session.user.role=token.role as string\r\n        }\r\n        return session\r\n    },\r\n  },\r\n  pages:{\r\n    signIn:\"/login\",\r\n    error:\"/login\"\r\n  },\r\n  session:{\r\n    strategy:\"jwt\",\r\n    maxAge:10*24*60*60*1000\r\n  },\r\n  secret:process.env.AUTH_SECRET\r\n})\r\n\r\n\r\n// connect db\r\n//email check\r\n//password match\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;;;;;;;AAGO,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,wKAAQ,EAAC;IAC1D,WAAW;QACT,IAAA,6KAAW,EAAC;YACR,aAAa;gBACb,OAAO;oBAAE,OAAO;oBAAQ,MAAK;gBAAQ;gBACrC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACD,MAAM,WAAU,WAAW,EAAE,OAAO;gBAE7B,MAAM,IAAA,mIAAS;gBACf,MAAM,QAAM,YAAY,KAAK;gBAC7B,MAAM,WAAS,YAAY,QAAQ;gBACnC,MAAM,OAAK,MAAM,iJAAI,CAAC,OAAO,CAAC;oBAAC;gBAAK;gBACpC,IAAG,CAAC,MAAK;oBACL,MAAM,IAAI,MAAM;gBACpB;gBACA,MAAM,UAAQ,MAAM,oJAAM,CAAC,OAAO,CAAC,UAAS,KAAK,QAAQ;gBACzD,IAAG,CAAC,SAAQ;oBACR,MAAM,IAAI,MAAM;gBACpB;gBACA,OAAO;oBACH,IAAG,KAAK,GAAG,CAAC,QAAQ;oBACpB,OAAM,KAAK,KAAK;oBAChB,MAAK,KAAK,IAAI;oBACd,MAAK,KAAK,IAAI;gBAClB;YAEF;QAEN;QACA,IAAA,wKAAM,EAAC;YACL,UAAS,QAAQ,GAAG,CAAC,gBAAgB;YACrC,cAAa,QAAQ,GAAG,CAAC,oBAAoB;QAC/C;KACD;IACD,WAAU;QACR,wCAAwC;QACxC,MAAM,QAAO,EAAC,IAAI,EAAC,OAAO,EAAC;YACzB,QAAQ,GAAG,CAAC;YACZ,IAAG,SAAS,YAAU,UAAS;gBAC7B,MAAM,IAAA,mIAAS;gBACf,IAAI,SAAO,MAAM,iJAAI,CAAC,OAAO,CAAC;oBAAC,OAAM,KAAK,KAAK;gBAAA;gBAChD,IAAG,CAAC,QAAO;oBACT,SAAO,MAAM,iJAAI,CAAC,MAAM,CAAC;wBACxB,MAAK,KAAK,IAAI;wBACd,OAAM,KAAK,KAAK;wBAChB,OAAM,KAAK,KAAK;oBACjB;gBACF;gBAEA,KAAK,EAAE,GAAC,OAAO,GAAG,CAAC,QAAQ;gBAC3B,KAAK,IAAI,GAAC,OAAO,IAAI;YACtB;YACA,OAAO;QACT;QACA,KAAI,EAAC,KAAK,EAAC,IAAI,EAAC,OAAO,EAAC,OAAO,EAAC;YAC5B,IAAG,MAAK;gBACJ,MAAM,EAAE,GAAC,KAAK,EAAE,EAChB,MAAM,IAAI,GAAC,KAAK,IAAI,EACpB,MAAM,KAAK,GAAC,KAAK,KAAK,EACtB,MAAM,IAAI,GAAC,KAAK,IAAI;YACxB;YACN,IAAG,WAAS,UAAS;gBACnB,MAAM,IAAI,GAAC,QAAQ,IAAI;YACzB;YAGM,OAAO;QACX;QACA,SAAQ,EAAC,OAAO,EAAC,KAAK,EAAC;YACnB,IAAG,QAAQ,IAAI,EAAC;gBACZ,QAAQ,IAAI,CAAC,EAAE,GAAC,MAAM,EAAE,EACxB,QAAQ,IAAI,CAAC,IAAI,GAAC,MAAM,IAAI,EAC5B,QAAQ,IAAI,CAAC,KAAK,GAAC,MAAM,KAAK;gBAC7B,QAAQ,IAAI,CAAC,IAAI,GAAC,MAAM,IAAI;YACjC;YACA,OAAO;QACX;IACF;IACA,OAAM;QACJ,QAAO;QACP,OAAM;IACR;IACA,SAAQ;QACN,UAAS;QACT,QAAO,KAAG,KAAG,KAAG,KAAG;IACrB;IACA,QAAO,QAAQ,GAAG,CAAC,WAAW;AAChC,GAGA,aAAa;CACb,aAAa;CACb,gBAAgB"}},
    {"offset": {"line": 254, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport type { NextRequest } from 'next/server'\r\nimport { auth } from './auth'\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    const session = await auth()\r\n    const { pathname } = request.nextUrl\r\n\r\n    // Protect farmer routes\r\n    if (pathname.startsWith('/farmer-dashboard')) {\r\n        if (!session?.user) {\r\n            return NextResponse.redirect(new URL('/login', request.url))\r\n        }\r\n        if (session.user.role !== 'farmer' && session.user.role !== 'shg') {\r\n            return NextResponse.redirect(new URL('/', request.url))\r\n        }\r\n    }\r\n\r\n    // Protect buyer routes\r\n    if (pathname.startsWith('/buyer-marketplace')) {\r\n        if (!session?.user) {\r\n            return NextResponse.redirect(new URL('/login', request.url))\r\n        }\r\n        if (session.user.role !== 'buyer' && session.user.role !== 'startup' && session.user.role !== 'processor') {\r\n            return NextResponse.redirect(new URL('/', request.url))\r\n        }\r\n    }\r\n\r\n    // Protect admin routes\r\n    if (pathname.startsWith('/admin')) {\r\n        if (!session?.user) {\r\n            return NextResponse.redirect(new URL('/login', request.url))\r\n        }\r\n        if (session.user.role !== 'admin') {\r\n            return NextResponse.redirect(new URL('/', request.url))\r\n        }\r\n    }\r\n\r\n    return NextResponse.next()\r\n}\r\n\r\nexport const config = {\r\n    matcher: ['/farmer-dashboard/:path*', '/buyer-marketplace/:path*', '/admin/:path*']\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,WAAW,OAAoB;IACjD,MAAM,UAAU,MAAM,IAAA,2HAAI;IAC1B,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,wBAAwB;IACxB,IAAI,SAAS,UAAU,CAAC,sBAAsB;QAC1C,IAAI,CAAC,SAAS,MAAM;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9D;QACA,IAAI,QAAQ,IAAI,CAAC,IAAI,KAAK,YAAY,QAAQ,IAAI,CAAC,IAAI,KAAK,OAAO;YAC/D,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACzD;IACJ;IAEA,uBAAuB;IACvB,IAAI,SAAS,UAAU,CAAC,uBAAuB;QAC3C,IAAI,CAAC,SAAS,MAAM;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9D;QACA,IAAI,QAAQ,IAAI,CAAC,IAAI,KAAK,WAAW,QAAQ,IAAI,CAAC,IAAI,KAAK,aAAa,QAAQ,IAAI,CAAC,IAAI,KAAK,aAAa;YACvG,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACzD;IACJ;IAEA,uBAAuB;IACvB,IAAI,SAAS,UAAU,CAAC,WAAW;QAC/B,IAAI,CAAC,SAAS,MAAM;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9D;QACA,IAAI,QAAQ,IAAI,CAAC,IAAI,KAAK,SAAS;YAC/B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACzD;IACJ;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC5B;AAEO,MAAM,SAAS;IAClB,SAAS;QAAC;QAA4B;QAA6B;KAAgB;AACvF"}}]
}