{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Agrowcart/AgrowCart/Agrowcart/client/src/app/api/ai/chatbot/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { message } = await req.json();\r\n\r\n        if (!process.env.GEMINI_API_KEY) {\r\n            console.error(\"GEMINI_API_KEY is missing\");\r\n            throw new Error(\"API Key missing\");\r\n        }\r\n\r\n        const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\r\n        // Using the latest flagship model for better reliability\r\n        const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n\r\n        const prompt = `You are Agrowcart AI, the official agricultural intelligence for Agrowcart platform.\r\n        \r\nUser identifies as someone interested in organic millets.\r\nUser Message: \"${message}\"\r\n\r\nYour Goal: Provide a friendly, expert response (max 2-3 sentences).\r\nPlatform Values:\r\n- Dedicated to the \"International Year of Millets\" initiative.\r\n- Direct Farmer-to-Consumer / SHG-to-Corporate connectivity.\r\n- Focus: Foxtail, Ragi, Bajra, Jowar, and other ancient grains.\r\n- Sustainability: Low water usage, gluten-free, and high nutrition.\r\n\r\nInstructions:\r\n- If asked about prices or stock: Refer them to the Marketplace page.\r\n- If asked about an order: Direct them to 'My Orders' in their dashboard.\r\n- If asked about health benefits: Highlight high fiber and mineral content.\r\n- Tone: Professional, warm, and tech-savvy. Use 1-2 green/farm emojis.`;\r\n\r\n        const result = await model.generateContent(prompt);\r\n        const response = await result.response;\r\n        const text = response.text();\r\n\r\n        // Fallback if text is empty\r\n        const reply = text || \"I am currently syncing my knowledge base with the latest harvest data. How else can I assist you? ðŸŒ¾\";\r\n\r\n        return NextResponse.json({ reply }, { status: 200 });\r\n\r\n    } catch (error: any) {\r\n        console.error(\"ChatBot API Error:\", error);\r\n        // Fallback message for UI continuity\r\n        return NextResponse.json(\r\n            { reply: \"Our digital farmer is taking a quick break to check the harvest! ðŸŒ¿ Please try asking again in a moment, or browse our fresh millets in the marketplace.\" },\r\n            { status: 200 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElC,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;YAC7B,QAAQ,KAAK,CAAC;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,QAAQ,IAAI,sLAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc;QAC/D,yDAAyD;QACzD,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QAEnE,MAAM,SAAS,CAAC;;;eAGT,EAAE,QAAQ;;;;;;;;;;;;;sEAa6C,CAAC;QAE/D,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,MAAM,OAAO,SAAS,IAAI;QAE1B,4BAA4B;QAC5B,MAAM,QAAQ,QAAQ;QAEtB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAM,GAAG;YAAE,QAAQ;QAAI;IAEtD,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,sBAAsB;QACpC,qCAAqC;QACrC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAA2J,GACpK;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}