{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Agrowcart/AgrowCart/Agrowcart/Agrowcart/src/app/api/ai/chatbot/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { message } = await req.json();\r\n\r\n        const prompt = `You are AgrowCart AI, a helpful assistant for an organic millet delivery platform.\r\n        \r\nUser Message: \"${message}\"\r\n\r\nYour Goal: Provide a helpful, concise response (max 2-3 sentences).\r\nContext:\r\n- AgrowCart connects farmers directly to consumers.\r\n- We sell Millets (Foxtail, Ragi, etc.), Pulses, and Value-added products.\r\n- We track product journey via blockchain for transparency.\r\n- We support farmers with fair prices.\r\n\r\nIf the user asks about specific stock, say you can check the marketplace page.\r\nIf the user asks about an order, ask them to check 'My Orders'.\r\nBe friendly and use 1-2 emojis.`;\r\n\r\n        // Using Gemini API\r\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${process.env.GEMINI_API_KEY}`, {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n                \"contents\": [\r\n                    {\r\n                        \"parts\": [{ \"text\": prompt }]\r\n                    }\r\n                ]\r\n            })\r\n        });\r\n\r\n        const data = await response.json();\r\n        const reply = data.candidates?.[0]?.content?.parts?.[0]?.text || \"I'm currently updating my knowledge base. Please try exploring our marketplace! ðŸŒ¿\";\r\n\r\n        return NextResponse.json({ reply }, { status: 200 });\r\n\r\n    } catch (error: any) {\r\n        console.error(\"ChatBot API Error:\", error.message);\r\n        // Status 200 with fallback message to prevent UI from breaking\r\n        return NextResponse.json(\r\n            { reply: \"I'm taking a short hydration break! ðŸŒ¿ In the meantime, you can find our best millets in the marketplace or check your profile.\" },\r\n            { status: 200 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElC,MAAM,SAAS,CAAC;;eAET,EAAE,QAAQ;;;;;;;;;;;+BAWM,CAAC;QAExB,mBAAmB;QACnB,MAAM,WAAW,MAAM,MAAM,CAAC,6FAA6F,EAAE,QAAQ,GAAG,CAAC,cAAc,EAAE,EAAE;YACvJ,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACjB,YAAY;oBACR;wBACI,SAAS;4BAAC;gCAAE,QAAQ;4BAAO;yBAAE;oBACjC;iBACH;YACL;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,QAAQ,KAAK,UAAU,EAAE,CAAC,EAAE,EAAE,SAAS,OAAO,CAAC,EAAE,EAAE,QAAQ;QAEjE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAM,GAAG;YAAE,QAAQ;QAAI;IAEtD,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,sBAAsB,MAAM,OAAO;QACjD,+DAA+D;QAC/D,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAkI,GAC3I;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}