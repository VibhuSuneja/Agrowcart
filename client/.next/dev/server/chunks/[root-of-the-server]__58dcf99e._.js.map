{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst mongodbUrl=process.env.MONGODB_URL\r\n\r\nif(!mongodbUrl){\r\n throw new Error(\"db error\")\r\n}\r\n\r\n\r\n\r\nlet cached=global.mongoose\r\nif(!cached){\r\n    cached=global.mongoose={conn:null,promise:null}\r\n}\r\n\r\nconst connectDb=async ()=>{\r\n    if(cached.conn){\r\n       \r\n        return cached.conn\r\n    }\r\n\r\n    if(!cached.promise){\r\n      \r\n        cached.promise=mongoose.connect(mongodbUrl).then((conn)=>conn.connection)\r\n    }\r\n    try {\r\n        const conn=await cached.promise\r\n        return conn\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n\r\n}\r\n\r\nexport default connectDb"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAW,QAAQ,GAAG,CAAC,WAAW;AAExC,IAAG,CAAC,YAAW;IACd,MAAM,IAAI,MAAM;AACjB;AAIA,IAAI,SAAO,yDAAO,QAAQ;AAC1B,IAAG,CAAC,QAAO;IACP,SAAO,yDAAO,QAAQ,GAAC;QAAC,MAAK;QAAK,SAAQ;IAAI;AAClD;AAEA,MAAM,YAAU;IACZ,IAAG,OAAO,IAAI,EAAC;QAEX,OAAO,OAAO,IAAI;IACtB;IAEA,IAAG,CAAC,OAAO,OAAO,EAAC;QAEf,OAAO,OAAO,GAAC,oHAAQ,CAAC,OAAO,CAAC,YAAY,IAAI,CAAC,CAAC,OAAO,KAAK,UAAU;IAC5E;IACA,IAAI;QACA,MAAM,OAAK,MAAM,OAAO,OAAO;QAC/B,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,GAAG,CAAC;IAChB;AAEJ;uCAEe"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/app/api/chat/ai-suggestions/route.ts"],"sourcesContent":["import connectDb from \"@/lib/db\";\r\nimport { connect } from \"http2\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        await connectDb()\r\n        const { message, role } = await req.json()\r\n        const prompt = `You are a professional delivery assistant chatbot.\r\n\r\nYou will be given:\r\n- role: either \"user\" or \"delivery_boy\"\r\n- last message: the last message sent in the conversation\r\n\r\nYour task:\r\nðŸ‘‰ If role is \"user\" â†’ generate 3 short WhatsApp-style reply suggestions that a user could send to the delivery boy.\r\nðŸ‘‰ If role is \"delivery_boy\" â†’ generate 3 short WhatsApp-style reply suggestions that a delivery boy could send to the user.\r\n\r\nâš ï¸ Follow these rules:\r\n- Replies must match the context of the last message.\r\n- Keep replies short, human-like (max 10 words).\r\n- Use emojis naturally (max one per reply).\r\n- No generic replies like \"Okay\" or \"Thank you\".\r\n- Must be helpful, respectful, and relevant to delivery, status, help, or location.\r\n- NO numbering, NO extra instructions, NO extra text.\r\n- Just return comma-separated reply suggestions.\r\n\r\nReturn only the three reply suggestions, comma-separated.\r\n\r\nRole: ${role}\r\nLast message: ${message}`\r\n\r\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${process.env.GEMINI_API_KEY}`, {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n                \"contents\": [\r\n                    {\r\n                        \"parts\": [\r\n                            {\r\n                                \"text\": prompt\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            })\r\n        })\r\n\r\n        const data=await response.json()\r\n        const replyText=data.candidates?.[0].content.parts?.[0].text || \"\"\r\n        const suggestions=replyText\r\n        .split(\",\")\r\n        .map((s:string)=>s.trim())\r\n        \r\n        return NextResponse.json(\r\n            suggestions,{status:200}\r\n        )\r\n\r\n    } catch (error) {\r\n return NextResponse.json(\r\n            {message:`gemini error ${error}`},{status:200}\r\n        )\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AAEA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,IAAA,6HAAS;QACf,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QACxC,MAAM,SAAS,CAAC;;;;;;;;;;;;;;;;;;;;;MAqBlB,EAAE,KAAK;cACC,EAAE,SAAS;QAEjB,MAAM,WAAW,MAAM,MAAM,CAAC,6FAA6F,EAAE,QAAQ,GAAG,CAAC,cAAc,EAAE,EAAE;YACvJ,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACjB,YAAY;oBACR;wBACI,SAAS;4BACL;gCACI,QAAQ;4BACZ;yBACH;oBACL;iBACH;YACL;QACJ;QAEA,MAAM,OAAK,MAAM,SAAS,IAAI;QAC9B,MAAM,YAAU,KAAK,UAAU,EAAE,CAAC,EAAE,CAAC,QAAQ,OAAO,CAAC,EAAE,CAAC,QAAQ;QAChE,MAAM,cAAY,UACjB,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,IAAW,EAAE,IAAI;QAEvB,OAAO,gJAAY,CAAC,IAAI,CACpB,aAAY;YAAC,QAAO;QAAG;IAG/B,EAAE,OAAO,OAAO;QACnB,OAAO,gJAAY,CAAC,IAAI,CACb;YAAC,SAAQ,CAAC,aAAa,EAAE,OAAO;QAAA,GAAE;YAAC,QAAO;QAAG;IAErD;AACJ"}}]
}