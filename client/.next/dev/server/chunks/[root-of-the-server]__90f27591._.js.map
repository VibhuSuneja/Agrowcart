{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst mongodbUrl=process.env.MONGODB_URL\r\n\r\nif(!mongodbUrl){\r\n throw new Error(\"db error\")\r\n}\r\n\r\n\r\n\r\nlet cached=global.mongoose\r\nif(!cached){\r\n    cached=global.mongoose={conn:null,promise:null}\r\n}\r\n\r\nconst connectDb=async ()=>{\r\n    if(cached.conn){\r\n       \r\n        return cached.conn\r\n    }\r\n\r\n    if(!cached.promise){\r\n      \r\n        cached.promise=mongoose.connect(mongodbUrl).then((conn)=>conn.connection)\r\n    }\r\n    try {\r\n        const conn=await cached.promise\r\n        return conn\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n\r\n}\r\n\r\nexport default connectDb"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAW,QAAQ,GAAG,CAAC,WAAW;AAExC,IAAG,CAAC,YAAW;IACd,MAAM,IAAI,MAAM;AACjB;AAIA,IAAI,SAAO,yDAAO,QAAQ;AAC1B,IAAG,CAAC,QAAO;IACP,SAAO,yDAAO,QAAQ,GAAC;QAAC,MAAK;QAAK,SAAQ;IAAI;AAClD;AAEA,MAAM,YAAU;IACZ,IAAG,OAAO,IAAI,EAAC;QAEX,OAAO,OAAO,IAAI;IACtB;IAEA,IAAG,CAAC,OAAO,OAAO,EAAC;QAEf,OAAO,OAAO,GAAC,oHAAQ,CAAC,OAAO,CAAC,YAAY,IAAI,CAAC,CAAC,OAAO,KAAK,UAAU;IAC5E;IACA,IAAI;QACA,MAAM,OAAK,MAAM,OAAO,OAAO;QAC/B,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,GAAG,CAAC;IAChB;AAEJ;uCAEe"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/models/recipe.model.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nexport interface IRecipe {\r\n    _id?: mongoose.Types.ObjectId;\r\n    title: string; // e.g., \"Ragi Dosa\"\r\n    description: string;\r\n    image: string;\r\n    video?: string; // Short video URL (Cloudinary/YouTube)\r\n    audioNote?: string; // Audio note URL\r\n    chef: string; // Name of user/chef\r\n    chefId?: mongoose.Types.ObjectId;\r\n    timeToCook: string; // e.g., \"30 mins\"\r\n    difficulty: \"Easy\" | \"Medium\" | \"Hard\";\r\n    ingredients: string[];\r\n    instructions: string[];\r\n    likes: number;\r\n    likedBy: mongoose.Types.ObjectId[]; // Track who liked for Instagram-style toggle\r\n    tags: string[]; // e.g., [\"Breakfast\", \"Gluten-Free\"]\r\n    createdAt?: Date;\r\n}\r\n\r\nconst recipeSchema = new mongoose.Schema<IRecipe>({\r\n    title: { type: String, required: true },\r\n    description: { type: String, required: true },\r\n    image: { type: String, required: true },\r\n    video: { type: String }, // Optional short video\r\n    audioNote: { type: String }, // Optional audio note\r\n    chef: { type: String, required: true },\r\n    chefId: { type: mongoose.Schema.Types.ObjectId, ref: \"User\" },\r\n    timeToCook: { type: String, required: true },\r\n    difficulty: { type: String, enum: [\"Easy\", \"Medium\", \"Hard\"], default: \"Medium\" },\r\n    ingredients: [{ type: String }],\r\n    instructions: [{ type: String }],\r\n    likes: { type: Number, default: 0 },\r\n    likedBy: [{ type: mongoose.Schema.Types.ObjectId, ref: \"User\" }],\r\n    tags: [{ type: String }]\r\n}, { timestamps: true });\r\n\r\nconst Recipe = mongoose.models.Recipe || mongoose.model(\"Recipe\", recipeSchema);\r\nexport default Recipe;\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAqBA,MAAM,eAAe,IAAI,oHAAQ,CAAC,MAAM,CAAU;IAC9C,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,aAAa;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC5C,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,OAAO;QAAE,MAAM;IAAO;IACtB,WAAW;QAAE,MAAM;IAAO;IAC1B,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,QAAQ;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAO;IAC5D,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC3C,YAAY;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;YAAU;SAAO;QAAE,SAAS;IAAS;IAChF,aAAa;QAAC;YAAE,MAAM;QAAO;KAAE;IAC/B,cAAc;QAAC;YAAE,MAAM;QAAO;KAAE;IAChC,OAAO;QAAE,MAAM;QAAQ,SAAS;IAAE;IAClC,SAAS;QAAC;YAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;KAAE;IAChE,MAAM;QAAC;YAAE,MAAM;QAAO;KAAE;AAC5B,GAAG;IAAE,YAAY;AAAK;AAEtB,MAAM,SAAS,oHAAQ,CAAC,MAAM,CAAC,MAAM,IAAI,oHAAQ,CAAC,KAAK,CAAC,UAAU;uCACnD"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///D:/grocery%20delivery/1.snapcartFolder/1.snapcartFolder/1.snapcart/src/app/api/recipes/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport connectDb from \"@/lib/db\";\r\nimport Recipe from \"@/models/recipe.model\";\r\n\r\n// GET: Get recipe details with like info\r\nexport async function GET(req: NextRequest, { params }: { params: Promise<{ id: string }> }) {\r\n    try {\r\n        await connectDb();\r\n        const { id } = await params;\r\n\r\n        const recipe = await Recipe.findById(id);\r\n        if (!recipe) {\r\n            return NextResponse.json({ message: \"Recipe not found\" }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json({\r\n            _id: recipe._id,\r\n            likes: recipe.likes,\r\n            likedBy: recipe.likedBy?.map((uid: any) => uid.toString()) || [],\r\n            likedByCount: recipe.likedBy?.length || 0\r\n        }, { status: 200 });\r\n    } catch (error) {\r\n        console.error(\"Get recipe error:\", error);\r\n        return NextResponse.json({ message: \"Error fetching recipe\" }, { status: 500 });\r\n    }\r\n}\r\n\r\n// PATCH: Fix/reset likes for a recipe (sync likes count with likedBy array length)\r\nexport async function PATCH(req: NextRequest, { params }: { params: Promise<{ id: string }> }) {\r\n    try {\r\n        await connectDb();\r\n        const { id } = await params;\r\n\r\n        const recipe = await Recipe.findById(id);\r\n        if (!recipe) {\r\n            return NextResponse.json({ message: \"Recipe not found\" }, { status: 404 });\r\n        }\r\n\r\n        // Reset likes count to match likedBy array length\r\n        const correctLikes = recipe.likedBy?.length || 0;\r\n\r\n        // Also deduplicate likedBy array\r\n        const uniqueLikedBy = [...new Set((recipe.likedBy || []).map((uid: any) => uid.toString()))];\r\n\r\n        await Recipe.findByIdAndUpdate(id, {\r\n            likes: uniqueLikedBy.length,\r\n            likedBy: uniqueLikedBy\r\n        });\r\n\r\n        return NextResponse.json({\r\n            message: \"Likes fixed\",\r\n            oldLikes: recipe.likes,\r\n            newLikes: uniqueLikedBy.length,\r\n            likedByCount: uniqueLikedBy.length\r\n        }, { status: 200 });\r\n    } catch (error) {\r\n        console.error(\"Fix likes error:\", error);\r\n        return NextResponse.json({ message: \"Error fixing likes\" }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAGO,eAAe,IAAI,GAAgB,EAAE,EAAE,MAAM,EAAuC;IACvF,IAAI;QACA,MAAM,IAAA,6HAAS;QACf,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,MAAM,SAAS,MAAM,6IAAM,CAAC,QAAQ,CAAC;QACrC,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,KAAK,OAAO,GAAG;YACf,OAAO,OAAO,KAAK;YACnB,SAAS,OAAO,OAAO,EAAE,IAAI,CAAC,MAAa,IAAI,QAAQ,OAAO,EAAE;YAChE,cAAc,OAAO,OAAO,EAAE,UAAU;QAC5C,GAAG;YAAE,QAAQ;QAAI;IACrB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ;AAGO,eAAe,MAAM,GAAgB,EAAE,EAAE,MAAM,EAAuC;IACzF,IAAI;QACA,MAAM,IAAA,6HAAS;QACf,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,MAAM,SAAS,MAAM,6IAAM,CAAC,QAAQ,CAAC;QACrC,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,kDAAkD;QAClD,MAAM,eAAe,OAAO,OAAO,EAAE,UAAU;QAE/C,iCAAiC;QACjC,MAAM,gBAAgB;eAAI,IAAI,IAAI,CAAC,OAAO,OAAO,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,MAAa,IAAI,QAAQ;SAAK;QAE5F,MAAM,6IAAM,CAAC,iBAAiB,CAAC,IAAI;YAC/B,OAAO,cAAc,MAAM;YAC3B,SAAS;QACb;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,UAAU,OAAO,KAAK;YACtB,UAAU,cAAc,MAAM;YAC9B,cAAc,cAAc,MAAM;QACtC,GAAG;YAAE,QAAQ;QAAI;IACrB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAqB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACJ"}}]
}